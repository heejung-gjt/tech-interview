### 왜 토큰을 사용하게 되었을까 ?

기존 인증 시스템방식은 __서버 기반 인증__ 이였다. 서버측에서 유저들의 정보를 기억하고 있어야 했다. 서버가 웹사이트를 제공하면 클라이언트가 로그인을 요청한다. 서버는 세션이 생성되고 유지되어 클라이언트에 응답을 보내주는 형식이였다. 현재도 많이 쓰이지만 몇몇 문제점이 존재한다.   

#### 서버 기반 인증 문제점    

- 유저가 인증할때 기록(세션)을 서버에 저장해야 하는데 대부분 메모리에 저장한다. 유저수가 늘게 되면 메모리도 늘게 되고 동시에 서버의 램에 과부하가 발생할 수 있다.    

- 세션을(인증할때 유저의 기록)을 사용하면 더 많은 트래픽을 감당하기 위해 여러개의 프로세스를 돌리거나 여러대의 서버 컴퓨터를 추가하는 것이 어려워진다.    

- CORS: 웹 어프리케이션에서 세션을 관리할때 자주 사용되는 쿠키는 단일 도메인 및 서브 도메인에서만 작동하도록 설계되어 있어 여러 도메인에서 관리하는 것이 번거롭다    

<br>

이를 해결하기 위해 __토큰 기반 인증__이 등장하였다.토큰기반은 stateless서버로 상태를 유지하지 않는다.(유저의 인증정보를 세션에 담아두지 않는다.) 구현 방식을 알아보자   
```
1. 유저가 로그인을 한다   
2. 서버측에서 해당 계정정보를 검증한다   
3. 계정정보가 정확하면 서버측에서 유저에게 signed토큰(signature를 담고있다)을 발급해준다    
4. 클라이언트는 전달받은 토큰을 저장해두고 서버요청시 해당 토큰을 함께 서버에 전달한다    
5. 서버는 토큰을 검증하고 요청에 응답한다    
```
#### 토큰의 장점 

- 토큰은 클라이언트쪽에 저장되기 때문에 서버를 여러대로 분산하여 사용해도 클라이언트가 서버에 토큰을 포함하여 요청하면 되기 때문에 가능하다.      

- 토큰을 사용하게 되면 쇼핑몰 로그인을 네이버나 페이스북으로 할 수 있는 것처럼 다른 서비스에서도 권한을 공유할 수 있다    

- 서버 요청시 더이상 쿠키로 전달하지 않기때문에 쿠키 사용으로 발생하는 취약점이 사라진다. 하지만 토큰을 중간에 탈취당하는 취약점이 존재하기 때문에 유효기간을 설정해준다. 
