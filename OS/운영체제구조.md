## 운영체제란
컴퓨터 시스템의 자원들을 효율적으로 관리하고 사용자가 컴퓨터를 편리하고 효과적으로 사용할 수 있도록 환경을 제공하는 여러 프로그램의 모임이다. __공통적인 기능을 묶어 하나의 프로그램을 만들어 사용하는 역할이 바로 운영체제이다__ 

<br>

## 운영체제가 나온 배경
폰노이만에 의해 컴퓨터가 처음 만들어졌다. 다른 기능을 하는 프로그램들이 가지고 있는 공통적인 기능도 각 프로그램마다 추가해야하는 비효율적인 처리를 했다. 예를 들어보자.      
- a,b,c의 역할을 하는 프로그램들의 공통적인 기능 -> 입출력 장치에게 명령하는 로직, 결과를 받는 로직, 메모리에 데이터를 올리는 로직  -> a,b,c 프로그램에서 따로따로 구현한다 -> 이를 개선하기 위해 공통적인 기능을 묶어 하나의 프로그램으로 만들고 a,b,c는 이 기능을 사용한다  
<br>

## 운영체제의 목적
- 처리능력 향상 (일정시간동안 처리하는 일의 양)   
 
- 응답시간 최소화 (작업에서 결과까지 걸리는 시간)

- 신뢰도 향상 (주어진 문제 얼마나 정확히 처리하는지)   

- 사용가능도 향상 (시스템을 얼마나 빠르게 사용하는지)   

- 예) 많은양의 계산을 할 줄 알면서 계산이 빠르고 답이 정확하고 얼마나 빨리 많은 계산을 넣을 수 있는지를 기준으로 두고 사용된다.

<br>

## 운영체제의 구조
![도식화3](https://user-images.githubusercontent.com/64240637/120246718-09d43e00-c2ac-11eb-8814-f794d2c9f53e.png)
 
 운영체제는 사용자와 하드웨어간의 중간 역할을 한다. 사용자가 응용 프로그램을 사용하여 운영체제에 요청을 한다. 요청을 받은 운영체제는 하드웨어에 있는 자원에서 요청받은 자원을 반환해준다. 이러한 사용자와 운영체제의 인터페이스 역할을 shell이라고 한다.    
 > 인터페이스 : 커널에 사용자의 명령을 전달하고 실행결과를 사용자에게 알려주거나 응용 프로그램에 반환하는 역할     
 
운영체제는 사용자 인터페이스와 응용프로그램을 위한 인터페이스를 제공한다     
- __사용자 인터페이스 제공(shell, CLI, GUI)__     
사용자 인터페이스는 컴퓨터 명령어를 shell에 한 줄씩 입력해 컴퓨터와 소통할 수 있는 역할을 한다. CLI와 GUI로 2가지가 존재한다. 
  - CLI : CMD, bash등 터미널을 통해 명령을 내린다
  - GUI : 마우스를 통해 아이콘으로 프로그램을 실행하거나 여러작업을 통해 명령을 내린다    

<br>

- __응용프로그램을 위한 인터페이스 제공__    
프로그래밍언어로 코드를 작성해 해당 프로그램이 실행될때 코드로 운영체제에 원하는 기능을 요청하는 역할을 한다. 운영체제에 요청할 수 있는 명령을 API라고 한다. API는 함수로 제공되는데 보통 함수를 종류별로 묶어 라이브러리 형태로 제공된다. 예를 들면 파일을 여는 open()함수를 API의 일종이라고 할 수 있다.    

<br>

![도식화](https://user-images.githubusercontent.com/64240637/120247656-3d649780-c2af-11eb-9a12-d027b61520a3.png)    
좀 더 자세한 구조를 살펴보면 응용프로그램이나 셸은 운영체제가 제공하는 API를 가지고 만들어져 사용자로부터 입력을 받으면 해당 요청에 맞는 API를 사용해서 운영체제에 요청한다. 

> API : 운영체제가 운영체제 기능을 애플리케이션이나 사용자가 쓸 수 있도록 여러가지 기능에 대해서 요청서를 제공해준다. 그것을 API형태로 제공해준다. 즉 API를 통해 자원을 요청할 수 있다.    

#### 운영체제의 시스템 콜(시스템 호출 인터페이스)
운영체제의 각 기능을 사용할 수 있도록 시스템 콜이라는 명령 또는 함수를 제공한다. API내부에서는 해당 운영체제 기능을 사용할 수 있는 시스템 콜을 호출하는 형태로 만들어지는 경우가 대부분이다. 응용 프로그램에서 운영체제에 요청을 할땐 API를 통해 시스템콜을 호출하고 시스템 콜이 호출되면 요청된 명령어는 운영체제 안으로 들어가 커널모드에서 실행되어진다.   
```
# (1) 1~100을 더하고 (2) 파일에서 데이터를 가져와 (3) 해당 데이터와 1~100을 더한 값을 다시 더한 후 출력하는 기능
(1),(3) 단순히 더하고 출력하는 기능이기 때문에 운영체제에 명령을 내릴 필요가 없다. 즉 시스테콜을 사용할 필요가 없다
(2) 필요한 파일의 자원이 필요하기 때문에 시스템콜을 통해 운영체제로 들어가 운영체제에서 필요한 데이터를 가져오는 명령을 커널에서 수행한 후 데이터를 다시 전달해준다
```
<br>

## 사용자 모드와 커널 모드
![모드](https://user-images.githubusercontent.com/64240637/120248520-823dfd80-c2b2-11eb-8f97-9efee5045761.png)

커널에서 중요한 자원을 관리하기 때문에 사용자가 그 중요한 자원에 접근할 수 없도록 모드를 2가지로 나누었다. 

cpu는 여러 모드의 명령을 지원하는데 주로 사용자모드와 커널모드 2가지의 모드를 사용한다. 
- 사용자 모드 : 사용자가 셸이나 응용프로그램으로 코드를 작성하고 수행하는 영역으로 프로그램의 자원을 직접적으로 사용할 수 없는 모드이다   
  
- 커널모드 : 명령어가 API를 통해 커널영억에서 수행되는 영역으로 모든 자원에 접근하고 명령을 할 수 있다.     

명령을 실행할때마다 현재 명령을 실행하고 있는 모드를 확인해서 이 모드가 사용자 모드에서 특권 명령어를 실행하려고 하면 Cpu가 실행하지 않는다.

> 커널 : OS의 핵심기능, OS가 CPU를 쓸 때 사용하는 모드

<br>

#### 사용자 모드와 커널모드의 전환
프로세스가 실행되는 동안에는 프로세스는 사용자모드와 커널모드를 왔다갔다한다. 예를 들어 프로그램에서 라이브러리 함수(open)를 호출하게 되면 open 내부에서 시스템 콜인 open을 호출하여 커널모드로 넘어간다. open에 대한 값이 커널에 전달되고 이 값을 반환하면서 사용자모드로 전환된다


----------------- 이하 위의 내용과 동일

## OS의 구조
운영체제는 크게 사용자와 응용 프로그램에 인접하여 커널에 명령을 전달하고 실행 결과를 돌려주는 __인터페이스__ 와 운영체제의 핵심 기능을 모아놓은 __커널__ 로 나뉜다. 커널에서 중요한 자원을 관리하기 때문에 직접 접근하지 못하도록 나누었다    

- 시스템 호출(System call) : 시스템 호출은 커널 스스로를 보호하기 위해 만든 인터페이스이다.  사용자나 응용프로그램으로부터 컴퓨터 자원을 보호하기 위해 자원에 직접 접근하는 것을 차단하기 위해 시스템 호출이라는 인터페이스를 이용해 접근한다 (커널이 제공하는 writer()함수를 사용하여 데이터 저장을 요청한다. 저장된 데이터를 확인하기 위해 read()함수로 시스템 호출을 이용해 가져온다)   
-  드라이버 : 하드웨어와 커널 사이의 인터페이스다. 하드웨어 제작자가 제공하는 드라이버도 있고 커널이 제공하는 드라이버도 있기 때문에 하드웨어와 커널이 직접 연결되기도 하고 드라이버를 통해 제동되기도 한다    

![r](https://user-images.githubusercontent.com/64240637/135624784-6ecc817a-6468-488e-b8f3-bf4a4d69769d.png)    


> __커널__    
프로세스 관리, 메모리 관리, 저장장치 관리와 같은 운영체제의 핵심적인 기능을 모아놓은 것      


![os구조](https://user-images.githubusercontent.com/64240637/135622255-7c7b4611-2abf-48c4-9af2-3656c0c9c856.png)

- CPU : 여러 프로그램에게 CPU 할당을 관리한다(CPU 스케줄링)    
- 메모리 관리 : 한정된 메모리에 여러개의 프로그램이 올라갈때 각 프로그램에게 할당해주어야 할 메모리를 관리한다    
- Disk : 디스크에 파일을 어떻게 보관할지 결정한다(파일관리)   
- I/O device : 각 다른 입출력장치와 컴퓨터 간에 정보를 어떻게 주고 받게 할지 결정한다(입출력 관리)

<br>

### 시스템 콜
커널모드의 기능을 사용자 모드가 사용 가능하게 해주는 것이다 즉, 프로세스가 하드웨어에 직접 접근해서 필요한 기능을 사용할 수 있게 해준다   

- 사용자 모드 : 프로그램의 자원에 함부로 침범하지 못하는 모드로 사용자의 애플리케이션을 실행하고, 코드의 작성, 프로세스의 실행 등 간단한 행동을 할 수 있다
- 커널모드 : 모든 자원에 접근/명령을 할 수 있다 

ex)
- 사용자 모드에서 시스템 콜이나 라이브러리 함수를 통해서 i/o를 요청한다   
- 사용자 모드에서 malloc을 통해서 메모리에 할당을 요청한다   