## 웹 동작 방식

### 1. 사용자가 웹 브라우저를 통해 원하는 웹 페이지의 url주소를 입력한다

   > __웹 브라우저란__   
    서버와 클라이언트간 양방향 통신을 하고 html문서나 파일을 출력하는 소프트웨어이다.   


   > __url이란__    
    네트워크 상에서 자원이 어디 있는지 알려주기 위한 규약이다. 웹주소나 인터넷 주소라고도 불린다   

<br>

### 2. 웹 브라우저는 입력받은 url을 분석한다    

![url](https://user-images.githubusercontent.com/64240637/135028311-7069003f-e8bb-42a7-b379-636fd61f4274.png)    

url의 구조와 다르다면 현재 프로그램의 검색엔진에 검색이 된다. ex) 크롬 - 크롬 검색엔진에 의해 검색된다    
url의 구조와 같다면 웹 브라우저는 __어떤 프로토콜을 통해 해당 url요청 할 것인지__, __어떤 url로 요청 할 것인지__, __어떤 포트로 요청 할 것인지__ 분석한다    

<br>

### 3. HSTS 목록을 조회한다
HSTS는 HTTP를 허용하지 않고 HTTPS를 사용하는 연결만 허용하는 기능으로 HTTP로 요청이 왔을 경우 브라우저에 HTTPS를 통해 요청하라는 필드를 헤더에 포함하여 응답한다. 이후 브라우저는 HSTS 캐시에 해당 URL을 캐싱한다(= HSTS 목록)    

<br>

### 4. URL을 IP주소로 변환한다
(3번에서 HTTPS를 통신한다고 가정)    
도메인 주소는 컴퓨터가 읽을 수 있는 IP주소로 변환해야 한다. 먼저 브라우저에서는 자신의 hosts파일과 브라우저 캐시에 url이 존재하는지 확인한다. 존재하지 않을 경우 IP주소로 변환해주는 DNS서버에 요청하여 URL과 매핑되는 IP주소를 얻는다      

#### [DNS변환 과정](https://github.com/heejung-gjt/tech-interview/blob/main/%20Network/DNS.md)    

DNS 서버로 요청하는 과정을 간단하게 작성해본다면     
```
1. Local DNS에 URL주소와 매핑되는 IP주소가 캐싱되어 있는지 확인한다
2. 캐싱되어 있지 않으면 root DNS서버에 URL과 매핑되는 IP주소를 요청한다
3. root DNS서버는 .com, .net 도메인을 관리하는 DNS서버에 IP주소를 요청한다   
4. .com.. 도메인을 관리하는 DNS서버에서 해당 도메인이 관리되는 서버에 IP주소를 요청한다
5. 해당 서버에서는 IP주소를 알려주고 동시에 Local DNS 서버에서는 해당 IP주소를 캐싱한다.
```   

<br>

### 5. 라우터의 라우팅을 통해 IP주소의 경로를 지정해준다   
DNS서버에서 받은 IP주소로 요청을 보내기 위해 라우팅을 사용해 경로를 지정받는다   

<br>

### 6. 통신을 하기 위해 물리 주소인 MAC주소로 변환한다
통신을 하기 위해서는 논리 주소인 IP주소를 물리 주소인 MAC주소로 변환해야 한다. ARP를 통해 IP주소를 MAC주소로 변환하여 응답한다.   


   > __ARP란__   
     네트워크 상에서 IP주소를 물리적 네트워크 주소(MAC)로 매핑시키기 위해 사용되는 프로토콜이다


   > __MAC주소란__    
     컴퓨터간 데이터를 전송하기 위해 있는 컴퓨터의 물리적 주소이다   
     내부적으로는 IP주소를 맥 주소로 바꾸어 사용하기 때문에 맥 주소 또한 알아야 통신이 가능하다

<br>

### 7. 서버와 TCP 연결을 한다
대상이 되는 서버와 통신을 위해서 3-way-handshake과정을 거친다. 서로를 검증한 후에 검증이 끝나면 connection된다. 이때 HTTPS 요청인 경우에는 TLS 핸드쉐이킹이 추가되어 통신을 암호화한다    

<br>

### 8. HTTP/HTTPS 프로토콜로 요청/응답
연결이 된 후 해당 서버에 요청한 자원을 요청한다. 서버는 해당 요청을 검사한 후 자원을 생성하여 브라우저에게 전달한다

<br>

### 9. 브라우저에서는 응답을 해석하여 화면에 그려준다
html, css, js등의 자원을 브라우저에서 해석하여 화면에 출력해준다   

