
## DNS(Domain Name System)

### DNS란
웹 사이트의 IP주소와 도메인 주소를 이어주는 환경/시스템이라고 한다(내부에서 각자의 역할을 하며 돌아가는 서버를 DNS 서버라고 한다)
DNS서버에서는 IP주소를 특정 도메인 주소와 같다는 기록을 저장해두고 사용자들이 도메인 주소를 검색했을때 IP주소로 연결되도록 해준다

### DNS 포트번호
UDP와 TCP 포트 번호 53번을 사용한다
UDP는 DNS조회를 할 경우 사용된다

### 과거 hosts
과거에는 컴퓨터의 os마다 hosts.txt파일을 가지고 있었다. hosts파일에는 모든 컴퓨터의 hostname과 ip주소가 저장되어 있었다. 클라이언트는 해당 파일을 다운로드하여 적용하였다. 이후 사용이 증가하면서 host가 증가하였고 이에 따라 다양한 어려움이 생겨났다

### DNS 동작방식
1. 유저가 브라우저에 example.com을 검색한다.

2. DNS서버로 도메인 주소가 전달된다

3. 서버 내부에서 example.com == 122.45.32.122이라는 항목을 찾아낸다

4. 브라우저에 122.45.32.122의 ip주소를 가지고 있는 호스팅 서버로 가라고 지시한다

5. 브라우저는 다시 ip주소로 접속하여 원하는 웹사이트에 접속한다

>호스팅 서버 : 해당 웹 사이트들의 데이터가 저장되어 있는 곳

### DNS 서버 종류
실제로 도메인 수는 굉장히 많기 때문에 __dns서버 종류를 계층화하여 단계적으로 처리한다는 것을 알아야 한다__

- Root DNS Server : 도메인을 총 관리하는 ICANN이 직접 관리하는 서버로 최상위 도메인 DNS 서버(TLD DNS server) IP들을 저장해두고 안내하는 역할을 한다 (***.com은 Com DNS 서버로 이동.. 등의 역할)

- TLD DNS Server(최상위 도메인 서버) : 도메인 등록 기관이 관리하는 서버로   Authoritative DNS 서버주소를 저장해두고 안내하는 역할을 한다.
(어떤 도메인 묶음이 어떤  Authoritative DNS server에 속하는지 아는이유는 도메인 판매업체의 DNS설정이 변경되면 도메인 등록기관으로 전달되기 때문이다)

- Authoritative DNS Server : 실제 개인 도메인과 IP주소의 관계가 기록/저장/변경되는 서버이다.

- Recursive DNS Server : 인터넷 사용자가 가장 먼저 접근하는 DNS서버이다. 한번 Root DNS Server까지 거쳐 얻은 데이터를 일정기간 동안 캐시형태로 저장해두는 서버이다.

__브라우저는 캐시가 저장된 Recursive 서버를 사용하고 실제 네임서버를 설정하는 곳은 Authoritative서버라는 점을 기억하자__

### DNS 동작 원리

![dns이미지지](https://user-images.githubusercontent.com/64240637/132820545-60610db9-60b7-48c9-917a-5f29023702ee.png)

1. 브라우저에서 example.com을 검색한다.

2. 사용하고 있는 통신사인 KT DNS서버(Recursive DNS 서버)에게 도메인 주소에 해당하는 ip주소를 요청한다 (브라우저 기본 DNS설정이 통신사 DNS서버이다)

3. 해당 통신사 서버에서 캐시 데이터가 없다는 것을 확인한 후 Root Server에게 어디로 가야하는지 요청한다

4. Root Server는 TLD DNS서버 주소만 관리하고 있기 때문에 xxx.com 도메인을 보고 COM 최상위 도메인을 관리하는 TLD DNS서버 주소를 안내한다

5. COM서버에서 어디로 가야하는지 다시 요청한다

6. COM 서버는 가비아DNS 서버에서 해당 도메인이 관리되고 있는 것을 확인하고 안내한다

7. 가비아 서버에 다시 어디로 가야하는지 요청한다

8. 가비아 서버는 example.com == 123.34.456.543라는 정보를 확인하고 해당 IP를 알려준다. 동시에 통신사 서버는 해당 정보를 캐시로 기록해둔다

9. 브라우저는 해당 IP주소를 가지고 있는 호스팅 서버에게 웹사이트를 보여달라고 요청한다

10. 정상적으로 웹사이트가 보여진다

> host   
> 각각의 인터넷에 연결된 컴퓨터들 즉, 네트워크에 연결되어 있는 컴퓨터

> 네임서버   
> 도메인 이름을 컴퓨터가 통신할때 사용하는 ip주소로 변환시켜주기 위한 정보를 가지고 있는 서버
<br>
###### [reference](https://gentlysallim.com/dns%EB%9E%80-%EB%AD%90%EA%B3%A0-%EB%84%A4%EC%9E%84%EC%84%9C%EB%B2%84%EB%9E%80-%EB%AD%94%EC%A7%80-%EA%B0%9C%EB%85%90%EC%A0%95%EB%A6%AC/)